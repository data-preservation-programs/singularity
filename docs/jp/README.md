# Singularityとは

Singularityは、データセットをFilecoinのストレージプロバイダに効率的にオンボードするためのエンドツーエンドのツールです。1ピーバイトスケールのデータを効率的にオンボードするために必要なすべての機能を備えています。

Singularityはモジュール化されており、データの準備やディールの作成ツールやサービスと連携するためのいくつかの異なる方法があります。

Singularityのユーザーは、Filecoinのストレージプロバイダに140ピービーのデータをオンボードしました。現在、SingularityはFilecoinクライアントによって使用されているトップのデータ準備ツールです。

## データの準備

Singularityには、データの準備モジュールが付属しており、データをローカルファイルシステムまたはリモートストレージサービス上で準備します。準備タスクはデータ準備ワーカーに分散して実行され、水平方向のスケーラビリティを実現します。

### 40以上のストレージタイプとの統合

Singularityは、Dropbox、Googleドライブなどの消費者向け製品からAWS S3、Azure Blobストレージ、FTP、HDFSなどのエンタープライズクラウドストレージソリューションなど、40以上の異なるタイプのリモートストレージサービスに接続することができる最初のツールです。これにより、ユーザーがすでに使用している既存のストレージソリューションとシームレスに統合することができます。

### インライン準備

Singularityは、インライン準備をサポートする最初のツールです。これにより、CARファイルを保存するための追加のディスクスペースが不要になります。代わりに、Singularityはメタデータデータベースを維持し、CARファイルを元のデータソースにマッピングします。そのため、ストレージプロバイダは元のデータソースからコンテンツを直接インポートすることができます。

### データセットの階層を維持

Singularityは、データセットのフォルダ構造とファイルのバージョンを維持するため、ユーザーはデータセットをフォルダごとに探索し、パスを使用してファイルを取得することができます。

### 暗号化

Singularityは、提供された受信者（公開鍵）またはYubiKeysなどのハードウェアPIVトークンでファイルを暗号化する組み込みの暗号化ソリューションをサポートしています。また、外部の暗号化ソリューションと統合するためのカスタム暗号化スクリプトを提供することもできます \[テストが必要です]。

## コンテンツの配布

Singularity自体は、ストレージプロバイダの操作（シーリングとプルーフ）を必要とせずに軽量なストレージプロバイダとして使用することもできます。ユーザーは、複数のプロトコル（Graphsync、HTTP、Bitswap）を使用してSingualrityサービスからCARファイルや元のファイルをダウンロードすることができます。

### CARの配布

ストレージプロバイダは、SingularityサーバからCARファイルをダウンロードすることができます。インライン準備が使用されている場合、SingularityはCARファイルをオリジナルのデータソースからリアルタイムにストリーミングしてダウンロードします。このダウンロードプロセスは、Boostマーケットディールの一部として実行され、マルチスレッティングをサポートしています。

### コンテンツの取得

Singularityは、すでに準備されたすべてのファイルに対してGraphsync/HTTP/Bitswapの取得を提供するため、ストレージプルーフを必要とせずにストレージプロバイダの代替として使用することができます。

## ディールの作成

Singularityでは、ディールを受け入れる意向のあるストレージプロバイダのリストを自分で持参する必要があります。ディールの作成には2つのモードがあります。プッシュモードでは、Singularityクライアントがディールを送信する方法を定義します。バッチで一度だけ送信する方法やスケジュールされたクロンでの送信方法などがあります。プルモードでは、ストレージプロバイダは、Singularityクライアントが設定したポリシーを満たす限り、ディールの提案を自ら要求することができます。

### プッシュモード

Singularityクライアントは、ストレージプロバイダとスケジュールを設定して、一定の間隔で一定数のディールを送信するように設定することができます。また、各スケジュールごとに最大ディール数やディールサイズを設定することもできます。さらに、いくつのフライト中のディールが許可されるかを設定することもできます。Singularityは、ディールがスラッシュされた場合、期限切れになった場合、または何らかの理由でチェーン上から消えた場合に、ディールの更新を処理します。

### プルモード

Singularityは、ストレージプロバイダが自身で提案することができるPieceCIDのリストをクエリすることを許可しています。ただし、そのストレージプロバイダがディール作成のセルフサービスポリシーで許可されている場合に限ります。これにより、ストレージプロバイダはシーリングパイプライン内でディールフローを完全に制御することができます。

### ウォレットの管理

Singularityでは、プライベートキーを使用してFilecoinウォレットをインポートし、データセットに複数のウォレットを関連付けることができます。Singularityは、各ウォレットのデータキャップを定期的にチェックして、異なるウォレット間で負荷を分散します。

Singularityはリモートサインヤーをサポートしているため、クライアントはウォレットの秘密キーを自分自身で保持することができます。