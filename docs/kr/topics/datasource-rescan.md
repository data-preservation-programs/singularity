# 데이터 소스 스캔

기본적으로 데이터 소스는 한 번만 스캔됩니다. 그러나 Singularity는 일정한 간격 후 데이터 소스를 다시 스캔할 수 있는 옵션을 제공합니다.

```sh
singularity datasource add <type> --rescan-interval value
```

또는 수동으로 스캔을 트리거할 수도 있습니다.

```sh
singularity datasource rescan datasource_id
```

스캔 중에는 새로운 파일이 모두 준비를 위해 대기열에 추가됩니다. 삭제된 파일은 무시됩니다.

#### 파일 버전 관리

변경된 파일에 대해, 해당 파일의 새로운 버전이 대기열에 추가되고 디렉토리 CID는 파일의 최신 버전을 사용하도록 업데이트됩니다.

파일이 변경되었는지 여부를 결정하는 논리는 다음과 같이 수행됩니다:

1. 데이터 소스가 파일의 해시 값(예: Etag)을 제공하면, 해시 값이 변경되면 새로운 버전이 생성됩니다.
2. 그렇지 않으면, 데이터 소스가 파일의 마지막 수정 시간을 제공하면 해당 값이 변경되거나 파일 크기가 변경되었을 때 새로운 버전이 생성됩니다.
3. 그렇지 않으면, 파일 크기를 사용하여 새 버전을 생성할지 여부가 결정됩니다.

같은 파일이 스캔 사이에 여러 번 덮어씌워질 경우 일부 파일 버전이 누락될 수 있습니다. 모든 파일 버전이 포착되도록 하려면 사용자는 [push-and-upload.md](push-and-upload.md "mention")를 사용하여 파일이 업데이트되어야 할 때마다 Singularity에 알려야 합니다.